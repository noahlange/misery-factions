<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>faction skirmish resolver</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <style type="text/css">
      body, #app {
        height: 100vh;
      }
      body {
        background-image: url('header.jpg');
        background-position: top center;
        background-size: contain;
        background-repeat: no-repeat;
      }
    </style>
  </head>
  <body>
    <div id="app" class="d-flex flex-column justify-content-between">
      <div class="container mt-5">
        <div class="row">
          <div class="col">
            <h1>
              faction skirmish resolver
              <b-button
                class="float-right ml-2"
                v-on:click="resolve(results, factions, true)"
                :variant="'outline-danger'"
              >
                fight quickly!
              </b-button>
              <b-button
                class="float-right"
                v-on:click="resolve(results, factions, false)"
                :variant="'danger'"
              >
                fight accurately!
              </b-button>
            </h1>
            <hr />
            <div style="column-count: 2;">
              <p>This is a <em>very</em> work-in-progress playtesting program for an RPG I'm working on. It's a simulation of an adaptation of a skirmish ruleset written for character combat, adjusted to model faction-level conflict.</p>
              <p>I hope to fine-tune the "fast resolve" mechanic and provide that as an option alongside the "accurate resolve" sim. You obviously don't need the nitty-gritty action resolution for something happening at the other end of the gameworld, but when it's within spitting distance of the PCs, the granularity is more important.</p><p>This is a good middle ground for close-but-not-too-close conflict, because each unit can be easily broken down into NPCs as needed. </p>
            </div>
          </div>
        </div>
        <hr class="py-1" />
        <div class="row">
          <div class="col">
            <div v-for="faction in factions" :key="faction.name">
              <b-card no-body class="mb-2">
                <b-card-header>
                  <h3 class="d-flex mb-0 justify-content-between">
                    <span v-if="faction.edit">
                      <b-form-select
                        v-model="faction.name"
                        v-on:change="updateFaction(faction, $event)"
                        :options="all_factions"
                      />
                    </span>
                    <span v-if="!faction.edit">
                      {{ faction.name }}
                    </span>
                    <b-button
                      :pressed.sync="faction.edit"
                      :variant="'outline-primary'"
                      class="float-right"
                    >
                      <span v-if="faction.edit" class="fa fa-fw fa-save"></span>
                      <span v-if="!faction.edit" class="fa fa-fw fa-edit"></span>
                    </b-button>
                  </h3>
                </b-card-header>

                <b-card-body v-if="faction.edit">
                  <b-input-group
                    class="mb-2"
                    v-for="squad in faction.squads"
                  >
                    <b-form-input v-model="squad.name" type="text" v-bind:placeholder="squad.title"></b-form-input>
                    <b-input-group-append>
                      <b-form-select v-on:change="updateRank(squad, $event)" v-model="squad.rank" :options="ranks" />
                    </b-input-group-append>
                    <b-input-group-append>
                      <b-button
                        :variant="'danger'"
                        v-on:click="removeSquad(faction, squad)"
                      >
                        <i class="fa fa-fw fa-times"></i>
                      </b-button>
                    </b-input-group-append>
                  </b-input-group>
                </b-card-body>
                <b-card-body v-if="!faction.edit">
                  <b-list-group>
                    <b-list-group-item
                      v-for="squad in faction.squads"
                      class="d-flex justify-content-between align-items-center"
                    >
                      {{ squad.title }}
                      <b-badge variant="primary" pill>{{ squad.rp }} RP</b-badge>
                    </b-list-group-item>
                  </b-list-group>
                </b-card-body>
                <b-card-footer v-if="faction.edit">
                  <b-button
                    class="float-right"
                    :variant="'success'"
                    v-on:click="addSquad(faction)"
                  >
                    <i class="fa fa-fw fa-plus"></i>
                  </b-button>
                </b-card-footer>
              </b-card>
            </div>
          </div>
          <div class="col">
            <b-card no-body v-if="!results.empty">
              <b-card-header>
                <h4 class="mb-0">
                  Combat log
                  <b-button
                    :variant="'dark'"
                    v-on:click="clear"
                    class="float-right"
                  >
                    Clear
                  </b-button>
                </h4>
              </b-card-header>
              <b-card-body style="max-height: 20rem; overflow-y: scroll;">
                <div class="mb-4" v-for="turn in results.log">
                  <pre><p class="mb-1" v-for="msg in turn">{{ msg }}</p></pre>
                </div>
              </b-card-body>
            </b-card>
          </div>
        </div>
      </div>
      <div class="container">
        <footer class="row">
          <div class="col py-5">
            <p>Code &copy; 2018 Noah Lange. Made with <i class="fa fa-heart-o text-danger"></i> in Madison, WI. <br />
            STALKER, &c., &copy; GSC Game World.</p>
          </div>
        </footer>
      </div>
    </div>
    <script type="text/javascript" src="/factions.js"></script>
  </body>
</html>